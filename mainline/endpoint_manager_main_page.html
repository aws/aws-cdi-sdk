<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<title>CDI SDK: Endpoint Manager Architecture</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="image_left.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CDI SDK
   </div>
   <div id="projectbrief">SDK for transporting chunks of data reliably and with low latency using a polled mode network driver.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Endpoint Manager Architecture</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#endpoint_manager_overview">Architecture Overview</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="endpoint_manager_overview"></a>
Architecture Overview</h1>
<p>In order to coordinate endpoint state changes such as reset, start and shutdown operations, a specific sequence of events must occur. There are many resouces such as queues, memory pools and threads that are used for an endpoint. All threads related to an endpoint must be blocked before any resource changes such as flushing queues or returning used memory pool items to their pool can be made. Once a state change completes, all threads are unblocked and return to their normal running state. The specific steps used are described below:</p><ol type="1">
<li>All threads related to the connection must register with then Endpoint Manager using <a class="el" href="endpoint__manager_8c.html#a32e7c2101fa44ae3b8e02181320fa25d">EndpointManagerThreadRegister()</a>. This does not include threads related to the probe control interface such as <a class="el" href="adapter__efa__probe__control_8c.html#a5f5f626def575681b9588a5951df962e">ProbeControlThread()</a>, since it runs all the time (never gets blocked).</li>
<li>When a request to perform an endpoint state change is made using <a class="el" href="endpoint__manager_8c.html#a14054c332bff6d2d8a566a0f069f62f4">EndpointManagerQueueEndpointReset()</a>, <a class="el" href="endpoint__manager_8c.html#a8020185abf536b8b0a3c051820aef759">EndpointManagerQueueEndpointStart()</a> or <a class="el" href="endpoint__manager_8c.html#afc0297b18dd599645fec47759cab01b1">EndpointManagerShutdownConnection()</a>, the <a class="el" href="structEndpointManagerState.html#ab6c00b99ebd33b635b5efb259e895037" title="Signal used to start processing a command.">EndpointManagerState::new_command_signal</a> is set. The Poll thread must call <a class="el" href="endpoint__manager_8c.html#a70cf151970ddb6cdbe0c52bad55a438e">EndpointManagerPoll()</a> as part of its normal poll loop to determine if it should perform adapter level polling or not. All other registered threads must monitor this signal and when set, must call <a class="el" href="endpoint__manager_8c.html#a5edbf8e5d8a66c7de64734bb75107ad4">EndpointManagerThreadWait()</a>, which blocks the thread.</li>
<li>After the non-poll registered threads have called <a class="el" href="endpoint__manager_8c.html#a5edbf8e5d8a66c7de64734bb75107ad4">EndpointManagerThreadWait()</a>, the endpoint state change is carried out using <a class="el" href="endpoint__manager_8c.html#a3356dbcf7576edd5e290347c465995f3">EndpointManagerThread()</a>.</li>
<li>After the endpoint state change completes, the registered threads that are blocked in <a class="el" href="endpoint__manager_8c.html#a5edbf8e5d8a66c7de64734bb75107ad4">EndpointManagerThreadWait()</a> are allowed to continue and calls to <a class="el" href="endpoint__manager_8c.html#a70cf151970ddb6cdbe0c52bad55a438e">EndpointManagerPoll()</a> by the poll thread will return true (can call adapter poll functions). NOTE: In a shutdown condition, the <a class="el" href="endpoint__manager_8c.html#a3356dbcf7576edd5e290347c465995f3">EndpointManagerThread()</a> exits as part of this process.</li>
</ol>
<p>The diagram shown below provides an overview of the Endpoint Manager architecture. </p><div class="image">
<img src="endpoint_manager_architecture.jpg" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
	<div>Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.</div>
</small></address>
</body>
</html>
