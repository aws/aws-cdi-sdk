<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<title>CDI SDK: src/cdi/payload.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="image_left.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CDI SDK
   </div>
   <div id="projectbrief">SDK for transporting chunks of data reliably and with low latency using a polled mode network driver.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_440858bc2ff41f5ef15b020e90223871.html">cdi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">payload.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file contains internal definitions and implementation used for payloads.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="payload_8h_source.html">payload.h</a>&quot;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="adapter__api_8h_source.html">adapter_api.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="adapter__efa__probe_8h_source.html">adapter_efa_probe.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="internal_8h_source.html">internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="internal__utility_8h_source.html">internal_utility.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="private_8h_source.html">private.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCdiPacketizerState.html">CdiPacketizerState</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to store the current state of a packet being constructed. Its purpose is to allow for the suspension of the creation of a packet if a pool from which items need to be allocated is empty. A state object is passed in to CdiPayloadInit() prior to calls to CdiPayloadParseCDIPacket() for a given payload.  <a href="structCdiPacketizerState.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a93ece93c7875292444466572ca19b05a" id="r_a93ece93c7875292444466572ca19b05a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93ece93c7875292444466572ca19b05a">PayloadInit</a> (<a class="el" href="structCdiConnectionState.html">CdiConnectionState</a> *con_state_ptr, const <a class="el" href="structCdiSgList.html">CdiSgList</a> *source_sgl_ptr, <a class="el" href="structTxPayloadState.html">TxPayloadState</a> *payload_state_ptr)</td></tr>
<tr class="separator:a93ece93c7875292444466572ca19b05a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdc72c22d57fe54fba818abc396058e1" id="r_abdc72c22d57fe54fba818abc396058e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abdc72c22d57fe54fba818abc396058e1">PayloadPacketizerCreate</a> (void)</td></tr>
<tr class="separator:abdc72c22d57fe54fba818abc396058e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a460b5cef20029828bf68f0b271350881" id="r_a460b5cef20029828bf68f0b271350881"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a460b5cef20029828bf68f0b271350881">PayloadPacketizerStateInit</a> (<a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> packetizer_state_handle)</td></tr>
<tr class="separator:a460b5cef20029828bf68f0b271350881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1baf5c6c4b43b03375cc76f903a5651f" id="r_a1baf5c6c4b43b03375cc76f903a5651f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1baf5c6c4b43b03375cc76f903a5651f">PayloadPacketizerDestroy</a> (<a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> packetizer_state_handle)</td></tr>
<tr class="separator:a1baf5c6c4b43b03375cc76f903a5651f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac57ebc3caacb72f661589d6f444deb12" id="r_ac57ebc3caacb72f661589d6f444deb12"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac57ebc3caacb72f661589d6f444deb12">PayloadPacketizerPacketGet</a> (<a class="el" href="payload_8h.html#a57182d381a4d1be37bfa792b77553e91">CdiProtocolHandle</a> protocol_handle, <a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> packetizer_state_handle, char *header_ptr, int header_buffer_size, <a class="el" href="cdi__pool__api_8h.html#a8e5912d6ac4676dac0adfb54cada3e03">CdiPoolHandle</a> packet_sgl_entry_pool_handle, <a class="el" href="structTxPayloadState.html">TxPayloadState</a> *payload_state_ptr, <a class="el" href="structCdiSgList.html">CdiSgList</a> *packet_sgl_ptr, bool *ret_is_last_packet_ptr)</td></tr>
<tr class="separator:ac57ebc3caacb72f661589d6f444deb12"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains internal definitions and implementation used for payloads. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a93ece93c7875292444466572ca19b05a" name="a93ece93c7875292444466572ca19b05a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93ece93c7875292444466572ca19b05a">&#9670;&#160;</a></span>PayloadInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PayloadInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCdiConnectionState.html">CdiConnectionState</a> *</td>          <td class="paramname"><span class="paramname"><em>con_state_ptr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structCdiSgList.html">CdiSgList</a> *</td>          <td class="paramname"><span class="paramname"><em>source_sgl_ptr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTxPayloadState.html">TxPayloadState</a> *</td>          <td class="paramname"><span class="paramname"><em>payload_state_ptr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize an <a class="el" href="structCdiPayloadPacketState.html" title="Structure used to hold state data for a single payload.">CdiPayloadPacketState</a> structure before using CdiPayloadPacketizerPacketGet() to split the payload into packets. NOTE: If an error occurs, caller is responsible for freeing the pool buffers that it allocates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con_state_ptr</td><td>Pointer to connection state data. </td></tr>
    <tr><td class="paramname">source_sgl_ptr</td><td>Pointer to Tx Payload source SGL list. </td></tr>
    <tr><td class="paramname">payload_state_ptr</td><td>Pointer to payload state data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful, otherwise an error occurred. </dd></dl>

</div>
</div>
<a id="abdc72c22d57fe54fba818abc396058e1" name="abdc72c22d57fe54fba818abc396058e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdc72c22d57fe54fba818abc396058e1">&#9670;&#160;</a></span>PayloadPacketizerCreate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> PayloadPacketizerCreate </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a packetizer state object. This must be destroyed with CdiPayloadPacketizerDestroy() when the connection is closed.</p>
<dl class="section return"><dt>Returns</dt><dd>Handle for the created packetizer state or NULL if the creation failed. </dd></dl>

</div>
</div>
<a id="a1baf5c6c4b43b03375cc76f903a5651f" name="a1baf5c6c4b43b03375cc76f903a5651f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1baf5c6c4b43b03375cc76f903a5651f">&#9670;&#160;</a></span>PayloadPacketizerDestroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PayloadPacketizerDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a></td>          <td class="paramname"><span class="paramname"><em>packetizer_state_handle</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory previously allocated for a packetizer state object through CdiPayloadPacketizerCreate().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetizer_state_handle</td><td>The handle of the packetizer state to be destroyed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac57ebc3caacb72f661589d6f444deb12" name="ac57ebc3caacb72f661589d6f444deb12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac57ebc3caacb72f661589d6f444deb12">&#9670;&#160;</a></span>PayloadPacketizerPacketGet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PayloadPacketizerPacketGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="payload_8h.html#a57182d381a4d1be37bfa792b77553e91">CdiProtocolHandle</a></td>          <td class="paramname"><span class="paramname"><em>protocol_handle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a></td>          <td class="paramname"><span class="paramname"><em>packetizer_state_handle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>header_ptr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>header_buffer_size</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdi__pool__api_8h.html#a8e5912d6ac4676dac0adfb54cada3e03">CdiPoolHandle</a></td>          <td class="paramname"><span class="paramname"><em>packet_sgl_entry_pool_handle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTxPayloadState.html">TxPayloadState</a> *</td>          <td class="paramname"><span class="paramname"><em>payload_state_ptr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCdiSgList.html">CdiSgList</a> *</td>          <td class="paramname"><span class="paramname"><em>packet_sgl_ptr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *</td>          <td class="paramname"><span class="paramname"><em>ret_is_last_packet_ptr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the next packet for a payload. Must use CdiPayloadPacketizerStateInit() for a new payload before using this function. If false is returned, one of the pools from which required resources are taken is dry so this function should be called again until it returns true.</p>
<p>NOTE: All the pools used in this function are not thread-safe, so must ensure that only one thread is accessing them at a time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protocol_handle</td><td>Handle of protocol to use. </td></tr>
    <tr><td class="paramname">packetizer_state_handle</td><td>Handle of the packetizer state for this connection. </td></tr>
    <tr><td class="paramname">header_ptr</td><td>Pointer to the header data structure to be filled in for the new packet. </td></tr>
    <tr><td class="paramname">header_buffer_size</td><td>Size of header data buffer in bytes. </td></tr>
    <tr><td class="paramname">packet_sgl_entry_pool_handle</td><td>CDI packet SGL list entry pool. </td></tr>
    <tr><td class="paramname">payload_state_ptr</td><td>Pointer to payload state data. </td></tr>
    <tr><td class="paramname">packet_sgl_ptr</td><td>Pointer to returned packet SGL list </td></tr>
    <tr><td class="paramname">ret_is_last_packet_ptr</td><td>Pointer to returned last packet state. True if last packet, otherwise false.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if packet returned, otherwise a pool was empty so false is returned. </dd></dl>

</div>
</div>
<a id="a460b5cef20029828bf68f0b271350881" name="a460b5cef20029828bf68f0b271350881"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a460b5cef20029828bf68f0b271350881">&#9670;&#160;</a></span>PayloadPacketizerStateInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PayloadPacketizerStateInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a></td>          <td class="paramname"><span class="paramname"><em>packetizer_state_handle</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes a packetizer state object. This function should be called before calling CdiPayloadPacketizerPacketGet() the first time for a given payload.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetizer_state_handle</td><td>Handle of packetizer object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
	<div>Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.</div>
</small></address>
</body>
</html>
